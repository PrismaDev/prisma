var LoginStringsModel = Backbone.Model.extend({
	defaults: {
		'matriculaLabel': 'Matrícula',
		'passwordLabel': 'Senha',
		'submitButtonLabel': 'Login',
		'loginHelpText': 'Para logar, use sua matrícula com sem o\
			dígito verificador e a mesma senha que você utiliza\
			para o PUC Online',
		'forgotPasswordText': 'Se você esqueceu sua senha, <a href=\
			"http://www.puc-rio.br/ensinopesq/academicas/">Clique aqui\
			</a>para acessar o PUC Online e recuperá-la',
		'infoText': 'O PrISMA, Programa de Instrução à Solicitação da\
			Matrícula Acadêmica, é um sistema desenvolvido por alunos\
			em parceria com o professor Sérgio Litschitz que tem como\
			objetivo facilitar o preenchimento da primeira fase da\
			matrícula',
		'openLoginFormButton': 'Abre login',
		'tutorialButton': 'Tutorial - em breve!'
	}
});

var loginStringsModel = new LoginStringsModel();
var LayoutStringsModel = Backbone.Model.extend({
	defaults: {
		'hiStr': 'Olá',
		'loginStr': 'Login',
		'logoutStr': 'Logout',
		'projectNameStr': 'PrISMA',
		'userName': 'Bobteco da Silva',
		'footerText': 'Esse projeto é uma colaboração dos alunos\
			Julio Ribeiro, Luiza Silva, Gabriel Martinelli,\
			André Marçal, Denis Neves, Glauber Borges e\
			Maurício Fragale com o professor Sérgio Lifschitz. \
			O código é aberto e pode ser encontrado no nosso\
			<a href="http://github.com/PrismaDev/prisma">\
			Github</a>'
	}
});

var layoutStringsModel = new LayoutStringsModel();
var LoginView = Backbone.View.extend({
	el: 'body',
	layoutTemplate: '',
	loginTemplate: '',

	initialize: function() {
		this.layoutTemplate = _.template($('#layout-template').html());
		this.loginTemplate = _.template($('#login-template').html());
	},

	initJS: function() {
		$('.dropdown-toggle').dropdown();
		$('ul div.dropdown-menu').click(function(e) {
			e.stopPropagation();
		});
	},
	
	render: function() {
		this.$el.html(this.layoutTemplate({
				loginStr: loginStringsModel,
				layoutStr: layoutStringsModel,
				loggedIn: false
		}));
		$('#content-div').html(this.loginTemplate({
			loginStr: loginStringsModel,
			layoutStr: layoutStringsModel
		}));
		
		this.initJS();
	}
});

var loginView = new LoginView();
var LoginRouter = Backbone.Router.extend({
	routes: {
		'': 'login'
	}
});

var loginRouter = new LoginRouter();
loginRouter.on('route:login', function() {
	loginView.render();
});

//if (history.pushState) { 
//	console.log("pushState supported");
//	Backbone.history.start({pushState: true});
//}
//else {
//	console.log("pushState NOT supported");
	Backbone.history.start();
//}
