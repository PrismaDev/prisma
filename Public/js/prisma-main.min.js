var TimetableView=Backbone.View.extend({template:"",startH:7,endH:23,ndays:6,initialize:function(){this.template=_.template($("#timetable-template").html())},buildTableBody:function(){for(var a=document.createElement("tbody"),b=this.startH;b<this.endH;b++){var c=document.createElement("tr");$(c).append("<td>"+b+":00</td>");for(var d=0;d<this.ndays;d++)$(c).append("<td></td>");$(a).append(c)}return $(a).html()},fetchData:function(){return{days:"Segunda Terca Quarta Quinta Sexta Sabado".split(" "),
startH:7,endH:23,timetableBody:this.buildTableBody()}},returnTemplate:function(){return _.template($("#timetable-template").html(),this.fetchData())},render:function(){this.$el.html(this.template(this.fetchData()))}}),timetableView=new TimetableView,FaltacursarView=Backbone.View.extend({template:"",initialize:function(){this.template=_.template($("#faltacursar-template").html())},events:{"click #faltacursar-table tr":"clickOnRow"},clickOnRow:function(a){a=$(a.target).parent("tr");$(a).hasClass("row_selected")?
($(a).removeClass("row_selected"),$("#faltacursar-classesList").addClass("hidden")):($("#faltacursar-table tr.row_selected").removeClass("row_selected"),$(a).addClass("row_selected"),$("#faltacursar-classesList").removeClass("hidden"),faltacursarClasseslistView.render([]))},initJS:function(){$("#faltacursar-table").dataTable({bPaginate:!1})},fetchStrings:function(){return{codeStr:"Codigo",nameStr:"Nome da Disciplina",moreInfoStr:"Ementa",termStr:"Periodo"}},fetchSubjects:function(){return{subjects:[{code:"MAT1015",
name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",term:"2",link:"#"},{code:"ENG1015",name:"Teste teste teste",
term:"2",link:"#"}]}},fetchData:function(){return $.extend({},this.fetchStrings(),this.fetchSubjects())},render:function(){this.$el.html(this.template(this.fetchData()));this.initJS();faltacursarClasseslistView.setElement("#faltacursar-classesList")}}),faltacursarView=new FaltacursarView,MicrohorarioView=Backbone.View.extend({template:"",waitingTemplate:"",noQueryTemplate:"",resultsDiv:"",noQueryStatus:"noQuery",queryStatus:"query",waitingStatus:"waiting",waitingImgURL:"http://i.stack.imgur.com/FhHRx.gif",
events:{"click #moreFiltersButton":"moreFilters","click #lessFiltersButton":"lessFilters","click #openFiltersButton":"openFilters","click #closeFiltersButton":"closeFilters"},moreFilters:function(){$("#hiddenFilters").removeClass("hidden");$("#lessFiltersButton").removeClass("hidden");$("#moreFiltersButton").addClass("hidden")},lessFilters:function(){$("#hiddenFilters").addClass("hidden");$("#lessFiltersButton").addClass("hidden");$("#moreFiltersButton").removeClass("hidden")},openFilters:function(){$("#microhorario-filter").removeClass("hidden");
$("#openFiltersButton").addClass("hidden");$("#closeFiltersButton").removeClass("hidden")},closeFilters:function(){$("#microhorario-filter").addClass("hidden");$("#openFiltersButton").removeClass("hidden");$("#closeFiltersButton").addClass("hidden")},initialize:function(){this.template=_.template($("#microhorario-template").html());this.waitingTemplate=_.template($("#microhorario-waiting-template").html());this.noQueryTemplate=_.template($("#microhorario-noquery-template").html())},changeState:function(a,
b){void 0==typeof b&&(b=[]);a==this.queryStatus?(microhorarioClasseslistView.render(b),this.closeFilters()):a==this.noQueryStatus?this.$resultsDiv.html(this.noQueryTemplate({noQueryStr:"No query"})):this.$resultsDiv.html(this.waitingTemplate({waitingImgURL:this.waitingImgURL}))},fetchStrings:function(){return{noQueryStr:"No query",subjectCodeStr:"Codigo da Disciplina:",subjectNameStr:"Nome da Disciplina:",professorNameStr:"Nome do Professor:",toggleBlocked:"Exibir disciplinas bloqueadas",moreFiltersStr:"More filters",
lessFiltersStr:"Less filters",openFiltersStr:"Open filters",closeFiltersStr:"Close filters"}},render:function(){this.$el.html(this.template(this.fetchStrings()));this.$resultsDiv=$("#microhorario-results");microhorarioClasseslistView.setElement(this.$resultsDiv);this.changeState(this.nQueryStatus)}}),microhorarioView=new MicrohorarioView,SelectedView=Backbone.View.extend({events:{"click #main-selected-div li":"handleClick"},handleClick:function(a){if($(a.target).hasClass("btn-primary"))$(a.target).removeClass("btn-primary");
else{var b=a.target.parent();$($(b).find("li")).each(function(a,b){$(b).removeClass("btn-primary")});$(a.target).addClass("btn-primary")}},sortableConfig:function(a){var b=this;$(a).sortable({connectWith:".selectedSortable",receive:function(a,d){3<$(this).children().length&&$(d.sender).sortable("cancel");0==$(d.sender).children().length&&$(d.sender).remove();if($("#main-selected-div ul").last().children().length){var e=document.createElement("ul");$(e).addClass("selectedSortable");$("#main-selected-div").append(e);
b.sortableConfig(e)}}})},initJS:function(){this.sortableConfig("#main-selected-div ul")},buildRow:function(a){var b=document.createElement("ul");$(b).addClass("selectedSortable");for(var c=0;c<a.length;c++)c?$(b).append('<li class="btn disabled">'+a[c].subcode+"-"+a[c].classcode+"</li>"):$(b).append('<li class="btn btn-primary disabled">'+a[0].subcode+"-"+a[0].classcode+"</li>");return b},buildSelected:function(a){var b=document.createElement("div");a[a.length]=[];for(var c=0;c<a.length;c++)$(b).append(this.buildRow(a[c]));
return $(b).html()},fetchData:function(){return[[{subcode:"ENG1232",classcode:"3VA"},{subcode:"ENG1232",classcode:"3VA"}],[{subcode:"ENG1232",classcode:"3VA"}],[{subcode:"ENG1232",classcode:"3VA"},{subcode:"ENG1232",classcode:"3VA"},{subcode:"ENG1232",classcode:"3VA"}]]},render:function(){var a=this.fetchData();this.$el.html(this.buildSelected(a));this.initJS()}}),selectedView=new SelectedView,MainView=Backbone.View.extend({el:"body",template:"",rendered:!1,tabs:{faltacursar:{li:"main-faltacursar-li",
div:"main-faltacursar-div",str:"",href:"#faltacursar"},microhorario:{li:"main-microhorario-li",div:"main-microhorario-div",str:"",href:"#microhorario"},selected:{li:"main-selected-li",div:"main-selected-div",str:"",href:"#selected"}},defaultTab:"faltacursar",initialize:function(){this.template=_.template($("#main-template").html());this.fetchStrings()},initJS:function(){$("#main-sidebar-div").resizable({handles:"e, w",maxWidth:0.6*$(window).width(),minWidth:0.25*$(window).width(),containment:"parent",
resize:function(){var a=$(".row-fluid").width()-$("#main-sidebar-div").outerWidth();$("#main-timetable-div").width(a-1)}})},setActiveTab:function(a){$("#main-tabs-nav li").removeClass("active");$("#main-tab-panes div").removeClass("active");$("#"+this.tabs[a].li).addClass("active");$("#"+this.tabs[a].div).addClass("active")},fetchStrings:function(){this.tabs.faltacursar.str="Falta Cursar";this.tabs.microhorario.str="Micro Horario";this.tabs.selected.str="Selecionadas"},renderSubviews:function(){timetableView.setElement("#main-timetable-div");
timetableView.render();faltacursarView.setElement("#main-faltacursar-div");faltacursarView.render();microhorarioView.setElement("#main-microhorario-div");microhorarioView.render();selectedView.setElement("#main-selected-div");selectedView.render()},render:function(){this.$el.html(this.template({tabs:this.tabs}));this.initJS();this.renderSubviews();this.rendered=!0}}),mainView=new MainView,ClasseslistView=Backbone.View.extend({template:"",initialize:function(){this.template=_.template($("#classeslist-template").html())},
initJS:function(){this.$el.find("table").dataTable({bPaginate:!1})},render:function(a){this.$el.html(this.template(a));this.initJS()}}),microhorarioClasseslistView=new ClasseslistView,faltacursarClasseslistView=new ClasseslistView;function SelectedController(){}var selectedController=new SelectedController,MainRouter=Backbone.Router.extend({routes:{"":"main",":tab":"tabs"}}),mainRouter=new MainRouter;mainRouter.on("route:main",function(){mainView.render();mainRouter.navigate(mainView.defaultTab,{trigger:!0})});
mainRouter.on("route:tabs",function(a){if(!mainView.tabs[a])return mainRouter.navigate(mainView.defaultTab,{trigger:!0,replace:!0});mainView.rendered||mainView.render();mainView.setActiveTab(a)});Backbone.history.start();
